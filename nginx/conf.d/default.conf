upstream user_service {
    server user-service:8000;
}

upstream ehr_service {
    server ehr-service:8002;
}

upstream appointment_service {
    server appointment-service:8003;
}

upstream prescription_service {
    server prescription-service:8001;
}

upstream laboratory_service {
    server laboratory-service:8004;
}

upstream billing_service {
    server billing-service:8005;
}

upstream notification_service {
    server notification-service:8006;
}

upstream admin_service {
    server admin-service:8007;
}

server {
    listen 80;
    server_name localhost;

    # User Service
    location /api/v1/users/ {
        proxy_pass http://user_service;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # EHR Service
    location /api/v1/ehr/ {
        proxy_pass http://ehr_service;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Appointment Service
    location /api/v1/appointments/ {
        proxy_pass http://appointment_service;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Prescription Service
    location /api/v1/prescriptions/ {
        proxy_pass http://prescription_service;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Laboratory Service
    location /api/v1/laboratory/ {
        proxy_pass http://laboratory_service;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Billing Service
    location /api/v1/billing/ {
        proxy_pass http://billing_service;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Notification Service
    location /api/v1/notifications/ {
        proxy_pass http://notification_service;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Admin Service
    location /api/v1/admin/ {
        proxy_pass http://admin_service;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Frontend
    location / {
        proxy_pass http://frontend:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
} 